if direnv version 2.23.0; then
    if ! has nix_direnv_version || ! nix_direnv_version 1.4.0; then
        source_url "https://raw.githubusercontent.com/nix-community/nix-direnv/1.4.0/direnvrc" \
            "sha256-4XfVDjv75eHMWN4G725VW7BoOV4Vl3vAabK4YXIfPyE="
    fi
fi

if nix flake metadata &>/dev/null; then
    use flake
else
    use nix
fi
